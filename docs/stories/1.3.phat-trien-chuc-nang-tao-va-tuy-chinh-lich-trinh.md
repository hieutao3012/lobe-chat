# Story 1.3: Phát triển chức năng tạo và tùy chỉnh lịch trình

## Status

Draft

## Story

**As a** người dùng,
**I want** tạo và tùy chỉnh lịch trình từ các địa điểm đã chọn,
**so that** tôi có thể lên kế hoạch chi tiết cho chuyến đi của mình.

## Acceptance Criteria

1. Người dùng có thể thêm/bỏ địa điểm vào danh sách lịch trình với một thao tác đơn giản
2. Giao diện kéo thả cho phép sắp xếp lại thứ tự các địa điểm trong lịch trình
3. Hệ thống tự động tạo lịch trình thô với giờ ước tính khi người dùng hoàn tất chọn địa điểm
4. Người dùng có thể xuất lịch trình dưới dạng text hoặc chia sẻ với người khác

## Tasks / Subtasks

- [ ] Task 1 (AC: 1)
  - [ ] Subtask 1.1: Thiết kế giao diện danh sách địa điểm đã chọn
  - [ ] Subtask 1.2: Xây dựng component hiển thị danh sách địa điểm trong lịch trình
  - [ ] Subtask 1.3: Thêm logic để thêm/bỏ địa điểm vào lịch trình
  - [ ] Subtask 1.4: Tạo unit test cho chức năng thêm/bỏ địa điểm

- [ ] Task 2 (AC: 2)
  - [ ] Subtask 2.1: Thiết kế giao diện kéo thả cho sắp xếp địa điểm
  - [ ] Subtask 2.2: Xây dựng component kéo thả với React DnD hoặc thư viện tương tự
  - [ ] Subtask 2.3: Tạo unit test cho chức năng kéo thả

- [ ] Task 3 (AC: 3)
  - [ ] Subtask 3.1: Xây dựng logic tạo lịch trình thô với giờ ước tính
  - [ ] Subtask 3.2: Tạo component hiển thị lịch trình đã tạo
  - [ ] Subtask 3.3: Tạo unit test cho chức năng tạo lịch trình

- [ ] Task 4 (AC: 4)
  - [ ] Subtask 4.1: Xây dựng chức năng xuất lịch trình dưới dạng text
  - [ ] Subtask 4.2: Thêm chức năng chia sẻ lịch trình (copy link, social sharing)
  - [ ] Subtask 4.3: Tạo unit test cho chức năng xuất và chia sẻ

## Dev Notes

### Data Models

Dựa trên cấu trúc trong tài liệu, model chính cho chức năng này là:

- `Itinerary`: Đại diện cho một lịch trình với các thuộc tính như `id`, `name`, `places`, `createdAt`, `updatedAt`, `estimatedTimes`.
- `ItineraryItem`: Mỗi địa điểm trong lịch trình với thông tin chi tiết và thời gian ước tính.

[Source: architecture/data-models.md]

### Component Specifications

Các component chính cần xây dựng:

- `ItineraryBuilder`: Component chính để xây dựng và quản lý lịch trình
- `ItineraryList`: Component hiển thị danh sách các địa điểm trong lịch trình
- `ItineraryItem`: Component hiển thị từng địa điểm trong lịch trình
- `ItineraryDetail`: Component hiển thị chi tiết lịch trình đã tạo
- `DragAndDropArea`: Component cho phép kéo thả sắp xếp địa điểm

[Source: architecture/components.md]

### File Locations

Theo cấu trúc dự án được mô tả, các file component mới nên được đặt trong:

- `src/components/itinerary/`: Chứa các component liên quan đến lịch trình
- `src/features/itinerary-planner/`: Chứa logic và services cho chức năng lập lịch trình

[Source: architecture/unified-project-structure.md]

### Testing Requirements

- Viết unit test cho tất cả các component và services được tạo
- Sử dụng React Testing Library để test component UI
- Test chức năng kéo thả với các trường hợp khác nhau
- Test chức năng tạo lịch trình với dữ liệu mẫu
- Test chức năng xuất và chia sẻ lịch trình

[Source: architecture/testing-strategy.md]

### Technical Constraints

- Dữ liệu lịch trình cần được lưu trữ tạm thời trong browser storage
- Giao diện phải responsive và hoạt động tốt trên cả mobile và desktop
- Component phải tương thích với Ant Design components đã có trong LobeChat
- Chức năng kéo thả phải mượt mà ngay cả với danh sách dài

[Source: architecture/tech-stack.md]

## Testing

### Testing Standards

- Test file location: Các file test sẽ được đặt cùng thư mục với file source code
- Test standards: Tuân theo các pattern testing được sử dụng trong LobeChat
- Testing frameworks: Sử dụng React Testing Library và Jest/Vitest như đã được cấu hình trong dự án
- Specific testing requirements: 
  - Test component render với dữ liệu mẫu
  - Test chức năng thêm/bỏ địa điểm
  - Test chức năng kéo thả với nhiều kịch bản
  - Test chức năng tạo lịch trình với các điều kiện khác nhau
  - Test chức năng xuất và chia sẻ

[Source: architecture/testing-strategy.md]

## Change Log

| Date | Version | Description | Author |
|------|---------|-------------|--------|
| 2025-08-28 | 1.0 | Initial story draft | Bob (Scrum Master) |